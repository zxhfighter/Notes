# å­—ç¬¦ä¸²çš„æ‰©å±•

## æ¨¡æ¿å­—ç¬¦ä¸²

æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²
ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚

```js
`${expression}`
```

## æ–°å¢æ–¹æ³•

### includes

åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŸä¸ªå­ä¸²ï¼Œä»¥å‰å¯ä»¥ä½¿ç”¨ `indexOf()` æ˜¯å¦ç­‰äº -1 æ¥åˆ¤æ–­æ˜¯å¦åŒ…å«ã€‚

```
str.includes(searchString[, position])
```

ä¾‹å­ï¼š

```ts
// ä»¥å‰ä½¿ç”¨ 'abcde'.indexOf('cd') !== -1
'abcde'.includes('cd') // => trueï¼Œ
'abcde'.includes('cd', 3) // => false
```

### startsWith

åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŸä¸ªå­ä¸²å¼€å¤´ï¼Œä»¥å‰å¯ä»¥ä½¿ç”¨ `indexOf()` æ˜¯å¦ç­‰äº 0 æ¥åˆ¤æ–­ã€‚

```
str.startsWith(searchString[, position])
```

ä¾‹å­ï¼š

```ts
'abcde'.startsWith('abc') // => trueï¼Œ
'abcde'.startsWith('cde', 2) // => true
'abcde'.startsWith('cde', 3) // => false
```

### endsWith

åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŸä¸ªå­ä¸²ç»“å°¾ï¼Œä»¥å‰å¯ä»¥ä½¿ç”¨ `indexOf()` ä»¥åŠå­—ç¬¦ä¸²çš„ç›¸å…³é•¿åº¦è®¡ç®—å¾—å‡ºã€‚

```
str.endsWith(searchString)
```

ä¾‹å­ï¼š

```ts
'abcde'.endsWith('de') // true
'.jpg'.endsWith(fileName)

// è‡ªå·±å®ç°çš„ç®—æ³•
function endsWith(str, substr) {
  if (substr.length > str.length) {
    return false;
  }
  return (str.length - substr.length) === str.indexOf(substr);
}
```

### repeat

å­—ç¬¦ä¸²é‡å¤ N éï¼Œå¯ä»¥ç”¨æ¥å¿«é€Ÿç”Ÿæˆæ•°æ®ï¼Œç­‰ä»·äº `Array(N).fill(str).join('')` ç”¨æ³•ã€‚

```ts
str.repeat(N)
```

ä¾‹å­ï¼š

```ts
'AB'.repeat(10)
Array(10).fill('AB').join('')
```

### padStart

åœ¨å­—ç¬¦ä¸²å¼€å§‹ä½ç½®å¡«å……ç‰¹å®šæ•°é‡çš„å¡«å……å­—ç¬¦ä¸²ï¼ˆå¦‚æœ‰éœ€è¦ï¼Œä¼šé‡å¤ï¼Œè¶…å‡ºä¼šæˆªæ–­ï¼‰ï¼Œä»¥ä¾¿è¾¾åˆ°æŒ‡å®šçš„å­—ç¬¦ä¸²ç›®æ ‡é•¿åº¦ã€‚

```
str.padStart(targetLength [, padString])
```

ä¾‹å­ï¼š

```ts
'abcd'.padStart(10, '012') // => 012012abcd
'abcd'.padStart(9, '012') // => 01201abcd
'abcd'.padStart(3, '012') // => abcd
```

### padEnd

åœ¨å­—ç¬¦ä¸²ç»“æŸä½ç½®å¡«å……ç‰¹å®šæ•°é‡çš„å¡«å……å­—ç¬¦ä¸²ï¼ˆå¦‚æœ‰éœ€è¦ï¼Œä¼šé‡å¤ï¼Œè¶…å‡ºä¼šæˆªæ–­ï¼‰ï¼Œä»¥ä¾¿è¾¾åˆ°æŒ‡å®šçš„å­—ç¬¦ä¸²ç›®æ ‡é•¿åº¦ã€‚

```
str.padEnd(targetLength [, padString])
```

ä¾‹å­ï¼š

```ts
'abcd'.padEnd(10, '012') // => abcd012012
'abcd'.padEnd(9, '012') // => abcd01201
'abcd'.padEnd(3, '012') // => abcd
```

## å¢å¼º Unicode è¡¨ç¤ºæ³•

JavaScript å…è®¸é‡‡ç”¨ `\uxxxx` å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­ `xxxx` è¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚

ä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•åªé™äºç ç‚¹åœ¨ `\u0000~\uFFFF` ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤ºã€‚

```js
"\uD842\uDFB7"
// "ğ ®·"

"\u20BB7"
// " 7"
```

ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨ `\u` åé¢è·Ÿä¸Šè¶…è¿‡ `0xFFFF` çš„æ•°å€¼ï¼ˆæ¯”å¦‚ `\u20BB7`ï¼‰ï¼ŒJavaScript ä¼šç†è§£æˆ `\u20BB+7`ã€‚
ç”±äº `\u20BB` æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª7ã€‚

ES6 å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚

```js
"\u{20BB7}"
// "ğ ®·"

"\u{41}\u{42}\u{43}"
// "ABC"

let hello = 123;
hell\u{6F} // 123


'\u{1F680}' === '\uD83D\uDE80'
// ğŸš€ === ğŸš€, true
```

ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ªä¾‹å­è¡¨æ˜ï¼Œå¤§æ‹¬å·è¡¨ç¤ºæ³•ä¸å››å­—èŠ‚çš„ UTF-16 ç¼–ç æ˜¯ç­‰ä»·çš„ã€‚

æœ‰äº†è¿™ç§è¡¨ç¤ºæ³•ä¹‹åï¼ŒJavaScript å…±æœ‰ 6 ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚

```js
'\z' === 'z'  // trueï¼ˆè½¬ä¹‰å­—ç¬¦ï¼Œæ²¡æœ‰è½¬ä¹‰è¿”å›å­—ç¬¦æœ¬èº«ï¼Œ'\n' åˆ™è¿”å›æ¢è¡Œï¼Œ'\t' åˆ™è¿”å› tab ç¼©è¿›ï¼‰
'\172' === 'z' // trueï¼ˆå…«è¿›åˆ¶å­—ç¬¦ï¼Œæ•°å­—çš„å…«è¿›åˆ¶å­—ç¬¦è¡¨ç¤ºå¦‚ä¸‹ 0o172ï¼‰
'\x7A' === 'z' // trueï¼ˆå•å­—èŠ‚ç¼–ç å­—ç¬¦ï¼ŒèŒƒå›´ 0~255ï¼‰
'\u007A' === 'z' // trueï¼ˆåŒå­—èŠ‚ç¼–ç å­—ç¬¦ï¼ŒèŒƒå›´ 0~65535ï¼‰
'\u{7A}' === 'z' // trueï¼ˆå­—ç¬¦çš„ Unicode å¤§æ‹¬å·è¡¨ç¤ºæ³•ï¼Œå¯ä»¥è¡¨è¾¾è¶…è¿‡åŒå­—èŠ‚çš„å­—ç¬¦äº†ï¼Œå¦å¤–å¯ä»¥çœç•¥å‰è¾¹çš„ 00 äº†ï¼‰
```

## codePointAt()

ä½œç”¨ï¼š**è¿”å›å­—ç¬¦çš„æ­£ç¡®ç ç‚¹çš„åè¿›åˆ¶ï¼Œå¯ä»¥å¤„ç†å››å­—èŠ‚å­˜å‚¨çš„å­—ç¬¦**

JavaScript å†…éƒ¨ï¼Œå­—ç¬¦ä»¥ UTF-16 çš„æ ¼å¼å‚¨å­˜ï¼Œæ¯ä¸ªå­—ç¬¦å›ºå®šä¸º2ä¸ªå­—èŠ‚ã€‚å¯¹äºé‚£äº›éœ€è¦4ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼ˆUnicode ç ç‚¹å¤§äº
 `0xFFFF` çš„å­—ç¬¦ï¼‰ï¼ŒJavaScript ä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªå­—ç¬¦ã€‚

```js
var s = "ğ ®·";

s.length // 2
s.charAt(0) // ''
s.charAt(1) // ''
s.charCodeAt(0) // 55362
s.charCodeAt(1) // 57271
```

ä¸Šé¢ä»£ç ä¸­ï¼Œæ±‰å­—â€œğ ®·â€ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªå­—ä¸æ˜¯â€œå‰ç¥¥â€çš„â€œå‰â€ï¼‰çš„ç ç‚¹æ˜¯ `0x20BB7`ï¼ŒUTF-16 ç¼–ç ä¸º`0xD842 0xDFB7`ï¼ˆåè¿›åˆ¶ä¸º
`55362 57271`ï¼‰ï¼Œéœ€è¦ 4 ä¸ªå­—èŠ‚å‚¨å­˜ã€‚å¯¹äºè¿™ç§ 4 ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScript ä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º 2ï¼Œè€Œä¸”
 charAt æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼ŒcharCodeAt æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚

**ES6 æä¾›äº† `codePointAt` æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç† 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹**ã€‚

```js
let s = 'ğ ®·a';

s.codePointAt(0) // 134071
s.codePointAt(1) // 57271

s.codePointAt(2) // 97
```

æ€»ä¹‹ï¼Œ`codePointAt` æ–¹æ³•ä¼šæ­£ç¡®è¿”å› 32 ä½çš„ UTF-16 å­—ç¬¦çš„ç ç‚¹ã€‚å¯¹äºé‚£äº›ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜çš„å¸¸è§„å­—ç¬¦ï¼Œå®ƒçš„è¿”å›ç»“æœä¸
`charCodeAt` æ–¹æ³•ç›¸åŒã€‚

**`codePointAt` æ–¹æ³•è¿”å›çš„æ˜¯ç ç‚¹çš„åè¿›åˆ¶å€¼**ï¼Œå¦‚æœæƒ³è¦åå…­è¿›åˆ¶çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ `toString(16)` æ–¹æ³•è½¬æ¢ä¸€ä¸‹ã€‚

```js
let s = 'ğ ®·a';

s.codePointAt(0).toString(16) // "20bb7"
s.codePointAt(2).toString(16) // "61"
```

ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œ`codePointAt` æ–¹æ³•çš„å‚æ•°ï¼Œä»ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦aåœ¨å­—ç¬¦ä¸²sçš„æ­£ç¡®ä½ç½®åºå·åº”è¯¥æ˜¯ 1ï¼Œ
ä½†æ˜¯å¿…é¡»å‘ `codePointAt` æ–¹æ³•ä¼ å…¥ 2ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨ `for...of` å¾ªç¯ï¼Œå› ä¸ºå®ƒä¼šæ­£ç¡®è¯†åˆ« 32 ä½çš„
UTF-16 å­—ç¬¦ã€‚

```js
let s = 'ğ ®·a';
for (let ch of s) {
  console.log(ch.codePointAt(0).toString(16));
}
// 20bb7
// 61
```

`codePointAt()` æ–¹æ³•æ˜¯æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯ç”±å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚

```js
function is32Bit(c) {
  return c.codePointAt(0) > 0xFFFF;
}

is32Bit("ğ ®·") // true
is32Bit("a") // false
```

## String.fromCodePoint()

ä½œç”¨ï¼š**æ ¹æ®ç ç‚¹è¿”å›å­—ç¬¦ï¼Œå¯ä»¥è¿”å›å¤§äº 0xFFFF çš„å­—ç¬¦**


ES6 æä¾›äº† `String.fromCodePoint` æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«å¤§äº `0xFFFF` çš„å­—ç¬¦ï¼Œå¼¥è¡¥äº†`String.fromCharCode` æ–¹æ³•çš„ä¸è¶³ã€‚
åœ¨ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸ `codePointAt` æ–¹æ³•ç›¸åã€‚

```js
String.fromCharCode(0x20BB7)
// "à®·"

String.fromCodePoint(0x20BB7)
// "ğ ®·"
String.fromCodePoint(0x78, 0x1f680, 0x79) === 'x\uD83D\uDE80y'
// true
```

æ³¨æ„ï¼Œ`fromCodePoint` æ–¹æ³•å®šä¹‰åœ¨ `String` å¯¹è±¡ä¸Šï¼Œè€Œ `codePointAt` æ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚

## å­—ç¬¦ä¸²éå†

ES6 ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼ˆè¯¦è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢« `for...of` å¾ªç¯éå†ã€‚

```js
for (let codePoint of 'foo') {
  console.log(codePoint)
}
// "f"
// "o"
// "o"
```

é™¤äº†éå†å­—ç¬¦ä¸²ï¼Œ**è¿™ä¸ªéå†å™¨æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¯†åˆ«å¤§äº `0xFFFF` çš„ç ç‚¹**ï¼Œä¼ ç»Ÿçš„ `for` å¾ªç¯æ— æ³•è¯†åˆ«è¿™æ ·çš„ç ç‚¹ã€‚

```js
let text = String.fromCodePoint(0x20BB7);

for (let i = 0; i < text.length; i++) {
  console.log(text[i]);
}
// " "
// " "

for (let i of text) {
  console.log(i);
}
// "ğ ®·"
```

## at()

ç›®å‰ï¼Œæœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºå­—ç¬¦ä¸²å®ä¾‹çš„ `at` æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ« Unicode ç¼–å·å¤§äº `0xFFFF` çš„å­—ç¬¦ï¼Œè¿”å›æ­£ç¡®çš„å­—ç¬¦ã€‚

```js
'abc'.charAt(0) // "a"
'ğ ®·'.charAt(0) // "\uD842"ï¼Œæ˜¾ç¤ºä¹±ç  ï¿½

'abc'.at(0) // "a"
'ğ ®·'.at(0) // "ğ ®·"
```

## matchAll()

matchAll æ–¹æ³•è¿”å›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨å½“å‰å­—ç¬¦ä¸²çš„æ‰€æœ‰åŒ¹é…ï¼Œè¯¦è§ã€Šæ­£åˆ™çš„æ‰©å±•ã€‹çš„ä¸€ç« ã€‚

## Unicode æ­£è§„åŒ–

ES6 æä¾›å­—ç¬¦ä¸²å®ä¾‹çš„ `normalize()` æ–¹æ³•ï¼Œç”¨æ¥å°†å­—ç¬¦çš„ä¸åŒè¡¨ç¤ºæ–¹æ³•ç»Ÿä¸€ä¸ºåŒæ ·çš„å½¢å¼ï¼Œè¿™ç§°ä¸º Unicode æ­£è§„åŒ–ã€‚

```js
'\u01D1'==='\u004F\u030C' // è¿™ä¸¤ä¸ªæ˜¯åŒä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯è¿”å› false

'\u01D1'.normalize() === '\u004F\u030C'.normalize() // æ­£è§„åŒ–åï¼Œè¿”å› true
```

## æ ‡ç­¾æ¨¡æ¿

æ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥è·Ÿåœ¨å‡½æ•°ï¼ˆæ ‡ç­¾ï¼‰åè¾¹ï¼Œå½¢æˆæ ‡ç­¾æ¨¡æ¿ã€‚

```js
const [a, b] = [5, 10];
console.log`Hello ${a + b} world ${ a * b }`

// ç­‰ä»·äºè°ƒç”¨ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ•°ç»„è¿˜æœ‰ä¸€ä¸ª raw å±æ€§ï¼Œraw é‡Œè¾¹ä¼šå°† \n å˜æˆ \\n
console.log(['Hello ', ' world ', ''], 15, 50)
```

â€œæ ‡ç­¾æ¨¡æ¿â€çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå°±æ˜¯è¿‡æ»¤ HTML å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚

```js
let message = SaferHTML`<p>${sender} has sent you a message.</p>`;

function SaferHTML(templateData) {
  let s = templateData[0];
  for (let i = 1; i < arguments.length; i++) {
    let arg = String(arguments[i]);

    // Escape special characters in the substitution.
    s += arg.replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;");

    // Don't escape special characters in the template.
    s += templateData[i];
  }
  return s;
}
```

"æ ‡ç­¾æ¨¡æ¿" çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œå°±æ˜¯å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚

```js
i18n`Welcome to ${siteName}, you are visitor number ${visitorNumber}!`
```

æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«å¹¶ä¸èƒ½å–ä»£ Mustache ä¹‹ç±»çš„æ¨¡æ¿åº“ï¼Œå› ä¸ºæ²¡æœ‰æ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯å¤„ç†åŠŸèƒ½ï¼Œä½†æ˜¯é€šè¿‡æ ‡ç­¾å‡½æ•°ï¼Œå¯ä»¥è‡ªå·±æ·»åŠ è¿™äº›åŠŸèƒ½ã€‚

```js
// ä¸‹é¢çš„hashTemplateå‡½æ•°
// æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¨¡æ¿å¤„ç†å‡½æ•°
let libraryHtml = hashTemplate`
  <ul>
    #for book in ${myBooks}
      <li><i>#{book.title}</i> by #{book.author}</li>
    #end
  </ul>
`;
```

é™¤æ­¤ä¹‹å¤–ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿ï¼Œåœ¨ JavaScript è¯­è¨€ä¹‹ä¸­åµŒå…¥å…¶ä»–è¯­è¨€ã€‚

```js
jsx`
  <div>
    <input
      ref='input'
      onChange='${this.handleChange}'
      defaultValue='${this.state.value}' />
      ${this.state.value}
   </div>`
```
